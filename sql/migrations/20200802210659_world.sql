DROP PROCEDURE IF EXISTS add_migration;
delimiter ??
CREATE PROCEDURE `add_migration`()
BEGIN
DECLARE v INT DEFAULT 1;
SET v = (SELECT COUNT(*) FROM `migrations` WHERE `id`='20200802210659');
IF v=0 THEN
INSERT INTO `migrations` VALUES ('20200802210659');
-- Add your query below.


-- kargath grunt should roam not pathfind
DELETE FROM `creature_movement` WHERE `id` = 6898;
UPDATE `creature` SET `position_x` = -6620.42, `position_y` = -2215.8, `position_z` = 244.269, `movement_type` = 1, `wander_distance` = 5 WHERE `guid` = 6898;

-- add servo waypoints and scripts
UPDATE `creature_template` SET `ai_name` = '' WHERE `entry` = 2922;
UPDATE `creature` SET `movement_type` = 2 WHERE `guid` = 7249;
DELETE FROM `creature_ai_events` WHERE `creature_id`=2922;
DELETE FROM `creature_ai_scripts` WHERE `id`IN (292201, 292202, 292203);
INSERT INTO `creature_movement_template` (`entry`, `point`, `position_x`, `position_y`, `position_z`, `orientation`, `waittime`, `wander_distance`, `script_id`) VALUES
(2922, 1, -6631.39, -2726.79, 243.585, 2.96706, 25000, 0, 292204),
(2922, 2, -6633.1, -2718.19, 243.968, 100, 0, 0, 0),
(2922, 3, -6644.94, -2710.01, 245.064, 100, 0, 0, 0),
(2922, 4, -6656.24, -2711.52, 242.568, 100, 0, 0, 0),
(2922, 5, -6667.67, -2720.87, 242.893, 100, 0, 0, 0),
(2922, 6, -6668.86, -2731.74, 243.128, 100, 0, 0, 0),
(2922, 7, -6661.89, -2740.65, 242.946, 100, 0, 0, 0),
(2922, 8, -6650.72, -2744.83, 242.467, 100, 0, 0, 0),
(2922, 9, -6641.93, -2744, 242.577, 100, 0, 0, 0),
(2922, 10, -6637.6, -2737.69, 243.057, 100, 0, 0, 0),
(2922, 11, -6632.26, -2730.05, 243.632, 100, 10000, 0, 292201),
(2922, 12, -6629.83, -2731.84, 243.952, 100, 0, 0, 0),
(2922, 13, -6626.84, -2731.86, 244.322, 100, 0, 0, 0),
(2922, 14, -6625.9, -2729.02, 244.383, 100, 0, 0, 0),
(2922, 15, -6630.4, -2726.7, 243.669, 100, 0, 0, 0),
(2922, 16, -6635.28, -2729.64, 243.431, 100, 0, 0, 0),
(2922, 17, -6638.85, -2734.38, 243.176, 100, 0, 0, 0),
(2922, 18, -6648.6, -2740.83, 242.495, 100, 0, 0, 0),
(2922, 19, -6655.65, -2750.56, 242.569, 100, 10000, 0, 292201),
(2922, 20, -6655.65, -2750.56, 242.569, 100, 0, 0, 292202),
(2922, 21, -6649.62, -2742.92, 242.473, 100, 0, 0, 0),
(2922, 22, -6650.89, -2735.79, 242.594, 100, 0, 0, 0),
(2922, 23, -6659.62, -2735.75, 242.864, 100, 0, 0, 0),
(2922, 24, -6668.86, -2731.74, 243.128, 100, 0, 0, 0),
(2922, 25, -6670.68, -2726.46, 242.937, 100, 0, 0, 0),
(2922, 26, -6657.19, -2715.05, 242.438, 100, 0, 0, 0),
(2922, 27, -6648.02, -2713.55, 243.86, 100, 0, 0, 0),
(2922, 28, -6638.08, -2716.45, 243.919, 100, 0, 0, 0),
(2922, 29, -6634.84, -2722.57, 243.386, 100, 10000, 0, 292201),
(2922, 30, -6634.84, -2722.57, 243.386, 100, 0, 0, 292203),
(2922, 31, -6631.83, -2722.68, 243.622, 100, 0, 0, 0),
(2922, 32, -6629.03, -2723.16, 243.893, 100, 0, 0, 0),
(2922, 33, -6626.65, -2728.26, 244.264, 100, 0, 0, 0),
(2922, 34, -6623.51, -2736.7, 244.597, 100, 0, 0, 0),
(2922, 35, -6625.27, -2743.45, 244.163, 100, 0, 0, 0),
(2922, 36, -6635.42, -2754.56, 243.485, 100, 0, 0, 0),
(2922, 37, -6649.49, -2753.88, 242.677, 100, 0, 0, 0),
(2922, 38, -6654.42, -2750.81, 242.555, 100, 0, 0, 0),
(2922, 39, -6650.2, -2739.49, 242.514, 100, 0, 0, 0),
(2922, 40, -6655.12, -2726.67, 242.787, 100, 0, 0, 0),
(2922, 41, -6652.57, -2715.81, 242.98, 100, 0, 0, 0),
(2922, 42, -6645.45, -2718.09, 243.475, 100, 0, 0, 0),
(2922, 43, -6634.76, -2714.72, 244.51, 100, 0, 0, 0),
(2922, 44, -6629.11, -2713.59, 244.916, 100, 0, 0, 0),
(2922, 45, -6626.1, -2713.86, 244.906, 100, 0, 0, 0),
(2922, 46, -6629.46, -2719.4, 244.099, 100, 10000, 0, 292201);
INSERT INTO `creature_movement_scripts` (`id`, `delay`, `command`, `datalong`, `datalong2`, `datalong3`, `datalong4`, `target_param1`, `target_param2`, `target_type`, `data_flags`, `dataint`, `dataint2`, `dataint3`, `dataint4`, `x`, `y`, `z`, `o`, `condition_id`, `comments`) VALUES (292201, 1, 39, 292201, 292202, 0, 0, 0, 0, 0, 0, 50, 50, 0, 0, 0, 0, 0, 0, 0, 'Servo - Start Script');
INSERT INTO `event_scripts` (`id`, `delay`, `command`, `datalong`, `datalong2`, `datalong3`, `datalong4`, `target_param1`, `target_param2`, `target_type`, `data_flags`, `dataint`, `dataint2`, `dataint3`, `dataint4`, `x`, `y`, `z`, `o`, `condition_id`, `comments`) VALUES (292201, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 901, 902, 903, 904, 0, 0, 0, 0, 0, 'Servo - Talk');
INSERT INTO `event_scripts` (`id`, `delay`, `command`, `datalong`, `datalong2`, `datalong3`, `datalong4`, `target_param1`, `target_param2`, `target_type`, `data_flags`, `dataint`, `dataint2`, `dataint3`, `dataint4`, `x`, `y`, `z`, `o`, `condition_id`, `comments`) VALUES (292202, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 905, 898, 900, 899, 0, 0, 0, 0, 0, 'Servo - Talk');
INSERT INTO `creature_movement_scripts` (`id`, `delay`, `command`, `datalong`, `datalong2`, `datalong3`, `datalong4`, `target_param1`, `target_param2`, `target_type`, `data_flags`, `dataint`, `dataint2`, `dataint3`, `dataint4`, `x`, `y`, `z`, `o`, `condition_id`, `comments`) VALUES (292202, 0, 25, 1, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Servo - Run');
INSERT INTO `creature_movement_scripts` (`id`, `delay`, `command`, `datalong`, `datalong2`, `datalong3`, `datalong4`, `target_param1`, `target_param2`, `target_type`, `data_flags`, `dataint`, `dataint2`, `dataint3`, `dataint4`, `x`, `y`, `z`, `o`, `condition_id`, `comments`) VALUES (292203, 0, 25, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Servo - Walk');
INSERT INTO `creature_movement_scripts` (`id`, `delay`, `command`, `datalong`, `datalong2`, `datalong3`, `datalong4`, `target_param1`, `target_param2`, `target_type`, `data_flags`, `dataint`, `dataint2`, `dataint3`, `dataint4`, `x`, `y`, `z`, `o`, `condition_id`, `comments`) VALUES (292204, 0, 4, 46, 2, 1, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Servo - Set Non Attackable');

-- add angor patrol (need waypoints, only partial are available in current sniff)
UPDATE `creature` SET `movement_type` = 0 WHERE `guid` = 7215;
DELETE FROM `creature_movement` WHERE `id` IN (7816, 7215);
INSERT INTO `creature_groups` (`leader_guid`, `member_guid`, `dist`, `angle`, `flags`) VALUES
(7816, 7215, 4, 15, 11),
(7816, 7216, 4, 17, 11);
INSERT INTO `creature_movement` (`id`, `point`, `position_x`, `position_y`, `position_z`, `orientation`, `waittime`, `script_id`) VALUES
(7816, 01, -6410.7085, -3177.1887, 290.43300, 100, 0, 0),
(7816, 02, -6413.2850, -3183.8904, 286.03458, 100, 0, 0),
(7816, 03, -6417.2640, -3192.6028, 279.83950, 100, 0, 0),
(7816, 04, -6426.7310, -3198.6790, 272.95450, 100, 0, 0),
(7816, 05, -6439.9556, -3203.3052, 265.12130, 100, 0, 0),
(7816, 06, -6454.2095, -3221.8801, 252.92722, 100, 0, 0),
(7816, 07, -6464.3400, -3237.9492, 244.91667, 100, 0, 0),
(7816, 08, -6469.4880, -3267.8645, 241.79167, 100, 0, 0),
(7816, 09, -6458.0283, -3289.2734, 241.79167, 100, 0, 0),
(7816, 10, -6445.4740, -3304.7570, 241.79167, 100, 0, 0),
(7816, 11, -6429.9043, -3321.7837, 241.79167, 100, 0, 0),
(7816, 12, -6416.5435, -3337.4575, 241.70993, 100, 0, 0),
(7816, 13, -6401.8643, -3353.8577, 241.70993, 100, 0, 0),
(7816, 14, -6391.8930, -3365.9236, 241.79167, 100, 0, 0),
(7816, 15, -6386.0234, -3380.2104, 241.70993, 100, 0, 0),
(7816, 16, -6388.4556, -3393.0950, 241.53268, 100, 0, 0),
(7816, 17, -6394.6797, -3397.9766, 239.86179, 100, 15000, 0),
(7816, 18, -6387.9277, -3389.4940, 241.70993, 100, 0, 0),
(7816, 19, -6385.4385, -3380.2805, 241.70993, 100, 0, 0),
(7816, 20, -6388.0684, -3364.7930, 241.79167, 100, 0, 0),
(7816, 21, -6392.4844, -3353.7861, 241.79167, 100, 0, 0),
(7816, 22, -6399.9140, -3341.1501, 241.79167, 100, 0, 0),
(7816, 23, -6403.5830, -3328.6775, 241.79167, 100, 0, 0),
(7816, 24, -6406.3228, -3316.0605, 241.79167, 100, 0, 0),
(7816, 25, -6407.4050, -3302.5930, 241.79167, 100, 0, 0),
(7816, 26, -6416.6313, -3285.2476, 241.79167, 100, 0, 0),
(7816, 27, -6427.1396, -3276.2896, 241.79167, 100, 0, 0),
(7816, 28, -6438.4526, -3267.1025, 241.79167, 100, 0, 0),
(7816, 29, -6448.3574, -3256.2268, 241.85686, 100, 0, 0),
(7816, 30, -6453.6025, -3246.1863, 243.20720, 100, 0, 0),
(7816, 31, -6454.6860, -3231.9050, 248.38058, 100, 0, 0),
(7816, 32, -6452.1143, -3220.9202, 254.32858, 100, 0, 0),
(7816, 33, -6445.5230, -3210.3950, 260.81418, 100, 0, 0),
(7816, 34, -6434.1855, -3200.5800, 268.81980, 100, 0, 0),
(7816, 35, -6423.5690, -3194.5442, 276.47305, 100, 0, 0),
(7816, 36, -6414.4785, -3185.3425, 284.78775, 100, 0, 0),
(7816, 37, -6410.4004, -3178.4668, 290.02676, 100, 0, 0),
(7816, 38, -6405.2563, -3171.3684, 295.44058, 100, 0, 0),
(7816, 39, -6401.3400, -3169.2942, 297.96988, 100, 15000, 0);


-- End of migration.
END IF;
END??
delimiter ; 
CALL add_migration();
DROP PROCEDURE IF EXISTS add_migration;
